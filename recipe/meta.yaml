{% set version = "0.1.3" %}

package:
  name: aeppl-suite
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/a/aeppl/aeppl-{{ version }}.tar.gz
  sha256: 0f7eadcf5b3c011e448e63e4dd8e29830fa41aef95cb4b4ce454a77bacaa8706
  patches:

build:
  number: 0
  # The following line seems to do nothing. Place noarch in the build block of individual outputs.
  noarch: python

outputs:
  - name: aeppl-base
    build:
      noarch: python
      script:
        - python -m pip install . --no-deps -vv
    requirements:
      host:
        - pip
        - python >=3.7
      run:
        - python >=3.7
        - numpy >=1.18.1
        - scipy >=1.4.0
        - aesara-base >=2.8.8
        - typing-extensions
    test:
      imports:
        - aeppl
      commands:
        - pip check
      requires:
        - pip

  - name: aeppl
    build:
      noarch: python
    requirements:
      host:
        - python >=3.7
      run:
        - python >=3.7
        - {{ pin_subpackage('aeppl-base', exact=True) }}
        # As of Aesara v2.7.5, there is a 1-1 correspondence between the "aesara-base"
        # package and the "aesara" package of the same version and build number on
        # which it depends. Thus the pin from the "aesara-base" package above will
        # implicitly transfer here to the "aesara" package.
        - aesara >=2.7.5
    test:
      imports:
        - aeppl
      commands:
        - pip check
      requires:
        - pip

about:
  home: https://github.com/aesara-devs/aeppl
  license: MIT
  summary: PPL tools for Aesara
  license_file: LICENSE
  dev_url: https://github.com/aesara-devs/aeppl/

extra:
  recipe-maintainers:
    - maresb
    - brandonwillard
    - rlouf
    - dgerlanc
